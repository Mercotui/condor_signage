<!DOCTYPE html>
<html style="height:100%">
<head>
    <meta charset="UTF-8">
    <title>Condor</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.8/flipclock.css" />
</head>

<body style="background:#ddd; margin:0; width:100%; height:100%; overflow:hidden;">
    <!-- Left hand collum -->
    <div style="background:#333; box-shadow:5px 0 5px -2px #888; width:60%; height:100%; float:left; overflow:hidden;">
        <div style="margin:2em; color:white;" onclick="config_transit()">
            <div id="transit">
                Hey ;)<br/> there <br/> put transit data here
            </div>
            <script type="text/javascript">
            function config_transit(){
                var key;
                var origin_id;
                var destination_id;
                while(key == null) {
                    key = prompt("Please enter your google API-key", localStorage.getItem("transit_key"));
                }
                while(origin_id == null) {
                    origin_id = prompt("Please enter your google location id for origin", localStorage.getItem("transit_origin_id"));
                }
                while(destination_id == null) {
                    destination_id = prompt("Please enter your google location id for origin", localStorage.getItem("transit_destination_id"));
                }
                localStorage.setItem("transit_key", key);
                localStorage.setItem("transit_origin_id", origin_id);
                localStorage.setItem("transit_destination_id", destination_id);
                update_transit();
            }
            function update_transit(){
                var key = localStorage.getItem("transit_key");
                var origin_id = localStorage.getItem("transit_origin_id");
                var destination_id = localStorage.getItem("transit_destination_id");

                if (key != null && origin_id != null && destination_id != null){
                    var complete_url = "https://maps.googleapis.com/maps/api/directions/json?origin=place_id:"+
                    origin_id+"&destination=place_id:"+destination_id+"&mode=transit&alternatives=true&key="+
                    key+"&callback=?";

                    //$.getJSON(complete_url, parse_transit_response);
                    $.ajax({url: complete_url, crossDomain : true, dataType: 'json', success: parse_transit_response});
                }
            }
            function parse_transit_response(result,status,xhr){
                document.getElementById("transit").innerHTML = ("GIT GUD");
            }
            </script>
        </div>
    </div>

    <!-- Right hand collum -->
    <div style="width:40%; height:100%; float:right; overflow:hidden;">
        <!-- Date box -->
        <div style="height:calc(1/3*100%); text-align: center; display:table; width:100%;">
            <div style="vertical-align:middle; display:table-cell;">
                <div style='color:#444; font: normal 100px "Tex Gyre Heros", GyreHeros-Bold, sans-serif; font-weight:bold; line-height: 80%; text-shadow: 2px 2px 2px #000;'>
                    <span id="day" style="font-size:50px;"></span><br/>
                    <span id="date" style="font-size:100px;"></span>
                </div>
                <script type="text/javascript">
                function update_date(){
                    //var d_names = ['S','MON','TUE','WED','THU','FRI','SAT'];
                    var d_names = ["SUNDAY", "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY"];
                    var m_names = new Array("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC");
                    var d = new Date();
                    var curr_day = d.getDay();
                    var curr_date = d.getDate();
                    var curr_month = d.getMonth();
                    document.getElementById("date").innerHTML = (curr_date+" "+m_names[curr_month]);
                    document.getElementById("day").innerHTML = d_names[curr_day];
                }
                </script>
            </div>
        </div>
        <!-- Time box -->
        <div style="height:calc(1/3*100%); text-align: center; display:table; width:100%;">
            <div style="vertical-align:middle; display:table-cell;">
                <div class="clock" style="display:inline-block; width:auto; transform:scale(1.5);"></div>
                <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.8/flipclock.min.js"></script>
                <script type="text/javascript">
                var clock;
                function init_clock() {
                    clock = $('.clock').FlipClock({
                        clockFace: 'TwentyFourHourClock',
                        showSeconds: false
                    });
                }
                </script>
            </div>
        </div>
        <!-- Weather box -->
        <div style="height:calc(1/3*100%); text-align:center; display:table; width:100%;">
            <div style="vertical-align:middle; display:table-cell;" onclick="config_weather()">
                <div style='color:#444; font: normal 100px "Tex Gyre Heros", GyreHeros-Bold, sans-serif; font-weight:bold; line-height: 60%;'>
                    <span id="weather_curr" style="font-size:100px;">CLICK HERE</span><br/>
                    <span id="weather_min" style="color:#777; font-size:30px; padding:1em;">To edit weather api settings</span>
                    <span id="weather_max" style="color:#555; font-size:30px; padding:1em;"></span>
                </div>
                <script type="text/javascript">

                function config_weather(){
                    var key;
                    var city;
                    while(key == null) {
                        key = prompt("Please enter your openweathermap.org API-key", localStorage.getItem("weather_key"));
                    }
                    while(city == null) {
                        city = prompt("Please enter your openweathermap.org city-ID", localStorage.getItem("weather_city_id"));
                    }
                    localStorage.setItem("weather_key", key);
                    localStorage.setItem("weather_city_id", city);
                    update_weather();
                }
                function update_weather(){
                    var key = localStorage.getItem("weather_key");
                    var city = localStorage.getItem("weather_city_id");

                    if (key != null && city != null){
                        $.getJSON( "http://api.openweathermap.org/data/2.5/weather?id="+city+"&APPID="+key+"&units=metric", parse_weather_response);
                    }
                }
                function parse_weather_response(data){
                    var curr_temp;
                    var max_temp;
                    var min_temp;
                    //function k_to_c(k){ return k-273.15;}
                    curr_temp = data.main.temp;
                    max_temp = data.main.temp_max;
                    min_temp = data.main.temp_min;

                    document.getElementById("weather_curr").innerHTML = (curr_temp.toFixed(1)+" "+String.fromCharCode(176)+"C");
                    document.getElementById("weather_max").innerHTML = (max_temp.toFixed(1)+" "+String.fromCharCode(176)+"C");
                    document.getElementById("weather_min").innerHTML = (min_temp.toFixed(1)+" "+String.fromCharCode(176)+"C");
                }
                </script>
            </div>
        </div>
    </div>

    <!-- init code -->
    <script type="text/javascript">
    $(document).ready(function() {
        update_date();
        init_clock();
        update_weather();
        update_transit();

        setInterval(update_date, 60000);
        setInterval(update_weather, 60000);
        setInterval(update_transit, 60000);
    });
    </script>
</body>
</html>
